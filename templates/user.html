<!-- 개인 페이지 -->
<!DOCTYPE html>
<html lang="kr">
<head>
    <meta charset="UTF-8">
    <title>User Page</title>
    <link rel="stylesheet" type="text/css" href = "../static/user.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>
        function image_post() {
            let title = $('#title').val()
            let file = $('#file')[0].files[0]
            let form_data = new FormData()

            form_data.append("title_give", title)
            form_data.append("file_give", file)
            $.ajax({
                type: "POST",
                url: "/user/fileupload",
                data: form_data,
                cache: false,
                contentType: false,
                processData: false,
                success: function (response) {
                    alert(response["result"])
                    window.location.reload()
                }
            });
        }
        function loading_user(){
            $.ajax({
                type:"POST",
                url:"/user/give_user_page",
                data:{},
                success: function (response) {
                    let user_list = response['result'];
                    let follow = user_list['follow'].length;
                    let follower = user_list['follower'].length;
                    $('#profile_place').append(`
                        <img src="../static/user_img/${user_list['profile_pic_name']}" style="width: 20vw; height: 20vw; max-width: 180px; max-height: 180px; border-radius: 50%; margin-right: 10px;"/>
                        `);
                    $('#profile_place').append(`<p>${user_list['user_id']}</p>`);
                    $('#post').append(`<p>${user_list['post_num']}</p>`);
                    $('#follower').append(`<p>${follower}</p>`);
                    $('#follow').append(`<p>${follow}</p>`);
                    console.log(user_list);
                    let comment_list = user_list['posts_list']
                    for(let i = 0; i < comment_list.length; i++) {
                        let comment = comment_list[i]['comment']
                        let writer = user_list['user_id']
                        let temp_comment = `<div class="card" style="width: 18rem; margin-top: 10px;">
                                                <div class="card-body text-center">
                                                    <h5 class="card-title">Comment</h5>
                                                    <p class="card-text">${comment}</p>
                                                </div>
                                                <ul class="list-group list-group-flush text-center">
                                                    <li class="list-group-item">${writer}</li>
                                                </ul>
                                            </div>`
                        $('#container-footer').append(temp_comment);
                    }

                }
            })
        }
        loading_user();
    </script>
</head>
<body>
    <div id="insta-wrapper">
        <div class="insta-status-bar">
            <div class="insta-status-bar__img">
                <img src="../static/image/home@3x.png" />
            </div>
            <div class="insta-status-bar__img">
                <img src="../static/image/insta-logo.png" style="height:40px;"/>
            </div>
            <div class="insta-status-bar__img">
                <img src="../static/image/dm@3x.png" />
            </div>
        </div>
        <div id="insta-container">
            <div id="profile_place" class="container-header">
            </div>
            <hr>
            <div class="file-upload">
                <div class="input-group flex-nowrap" style="margin-bottom: 10px;">
                    <span class="input-group-text" id="addon-wrapping">@</span>
                    <input id="title" type="text" class="form-control text-center" placeholder="업로드할 이미지 제목을 입력해주세요" aria-label="Username"
                           aria-describedby="addon-wrapping">
                </div>
                <div class="input-group mb-3" style="width:500px;">
                    <input type="file" class="form-control" id="file">
                    <button onclick="image_post()" type="button" class="btn btn-secondary">업로드</button>
                </div>
            </div>
            <hr>
            <div class="container-main">
                <div class="container-main-sub">
                    <p>팔로워</p>
                    <div id="post">
                    </div>
                </div>
                <div class="container-main-sub">
                    <p>팔로워</p>
                    <div id="follower">
                    </div>
                </div>
                <div class="container-main-sub">
                    <p>팔로우</p>
                    <div id="follow">
                    </div>
                </div>
            </div>
            <div class="container-footer" id="container-footer">
                <div class="card" style="width: 18rem;">
                    <div class="card-body text-center">
                        <h5 class="card-title">Comment</h5>
                        <p class="card-text">이 곳에 내용이 들어갑니다.</p>
                    </div>
                    <ul class="list-group list-group-flush text-center">
                        <li class="list-group-item">작성자</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="insta-nav">
            <div class="insta-nav__img">
                <img src="../static/image/home@3x.png"/>
            </div>
            <div class="insta-nav__img">
                <img src="../static/image/search@3x.png"/>
            </div>
            <div class="insta-nav__img">
                <img src="../static/image/trending@3x.png"/>
            </div>
            <div class="insta-nav__img">
                <img src="../static/image/like@3x.png"/>
            </div>
            <div class="insta-nav__img">
                <img src="../static/image/user2.png" style="width: 43px; margin-bottom: 10px"/>
            </div>
        </div>
    </div>
</body>
</html>
